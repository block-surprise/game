<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ã‚¹ã‚¿ãƒ¼ãƒ»ãƒ‡ã‚£ãƒ•ã‚§ãƒ³ãƒ€ãƒ¼</title>
    <meta name="google-adsense-account" content="ca-pub-3571574988222927">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3571574988222927" crossorigin="anonymous"></script>
    <link rel="icon" href="https://games.ad-hub.f5.si/image/favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="https://games.ad-hub.f5.si/image/apple-touch-icon.png">
    <meta name="theme-color" content="#007bff">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: sans-serif; touch-action: none; }
        canvas { display: block; background: radial-gradient(circle, #1b2735 0%, #090a0f 100%); }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: #00d2ff; font-family: 'Courier New', monospace; pointer-events: none; }
        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; color: #fff; z-index: 100; }
        .btn { background: #00d2ff; color: #000; border: none; padding: 15px 40px; border-radius: 5px; font-size: 1.2rem; cursor: pointer; font-weight: bold; }
        .back-link { margin-top: 20px; color: #888; text-decoration: none; }
    </style>
</head>
<body>

    <div id="ui">SCORE: <span id="score">0</span></div>
    <canvas id="gameCanvas"></canvas>

    <div id="overlay">
        <h1 style="color:#00d2ff; letter-spacing: 5px;">STAR DEFENDER</h1>
        <p>ãƒ‰ãƒ©ãƒƒã‚°/ãƒã‚¦ã‚¹ç§»å‹•ã§æ“ä½œï¼†è‡ªå‹•å°„æ’ƒï¼</p>
        <button class="btn" onclick="startGame()">MISSION START</button>
        <a href="/" class="back-link">â† ä¸€è¦§ã«æˆ»ã‚‹</a>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreDisp = document.getElementById('score');
    const overlay = document.getElementById('overlay');

    let player, bullets, enemies, particles, score, gameActive;
    
    function init() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        player = { x: canvas.width / 2, y: canvas.height - 80, size: 30 };
        bullets = [];
        enemies = [];
        particles = [];
        score = 0;
        gameActive = false;
    }

    function startGame() {
        init();
        gameActive = true;
        overlay.style.display = 'none';
        loop();
    }

    function loop() {
        if (!gameActive) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æç”» (ğŸš€)
        ctx.font = "40px Arial";
        ctx.fillText("ğŸš€", player.x - 20, player.y + 15);

        // å¼¾ã®ç”Ÿæˆ
        if (Date.now() % 150 < 20) {
            bullets.push({ x: player.x, y: player.y - 20 });
        }

        // å¼¾ã®ç§»å‹•ãƒ»æç”»
        ctx.fillStyle = "#00d2ff";
        bullets.forEach((b, i) => {
            b.y -= 10;
            ctx.fillRect(b.x - 2, b.y, 4, 15);
            if (b.y < 0) bullets.splice(i, 1);
        });

        // æ•µã®ç”Ÿæˆ
        if (Math.random() < 0.05 + (score / 10000)) {
            enemies.push({ x: Math.random() * (canvas.width - 40) + 20, y: -50, speed: 2 + Math.random() * 3 });
        }

        // æ•µã®ç§»å‹•ãƒ»æç”»
        enemies.forEach((e, i) => {
            e.y += e.speed;
            ctx.fillText("ğŸ‘¾", e.x - 20, e.y + 15);

            // å½“ãŸã‚Šåˆ¤å®š (å¼¾ vs æ•µ)
            bullets.forEach((b, bi) => {
                if (Math.abs(b.x - e.x) < 20 && Math.abs(b.y - e.y) < 20) {
                    createParticles(e.x, e.y);
                    enemies.splice(i, 1);
                    bullets.splice(bi, 1);
                    score += 100;
                    scoreDisp.innerText = score;
                }
            });

            // å½“ãŸã‚Šåˆ¤å®š (ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ vs æ•µ)
            if (Math.abs(player.x - e.x) < 30 && Math.abs(player.y - e.y) < 30) {
                gameOver();
            }

            if (e.y > canvas.height) enemies.splice(i, 1);
        });

        // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ï¼ˆçˆ†ç™ºï¼‰ã®æç”»
        particles.forEach((p, i) => {
            p.x += p.vx;
            p.y += p.vy;
            p.alpha -= 0.02;
            ctx.fillStyle = `rgba(255, 165, 0, ${p.alpha})`;
            ctx.beginPath();
            ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
            ctx.fill();
            if (p.alpha <= 0) particles.splice(i, 1);
        });

        requestAnimationFrame(loop);
    }

    function createParticles(x, y) {
        for (let i = 0; i < 10; i++) {
            particles.push({
                x, y,
                vx: (Math.random() - 0.5) * 5,
                vy: (Math.random() - 0.5) * 5,
                alpha: 1
            });
        }
    }

    function gameOver() {
        gameActive = false;
        overlay.style.display = 'flex';
        overlay.querySelector('h1').innerText = "MISSION FAILED";
        overlay.querySelector('p').innerText = `FINAL SCORE: ${score}`;
    }

    const moveHandler = (e) => {
        const x = e.touches ? e.touches[0].clientX : e.clientX;
        player.x = x;
    };

    window.addEventListener('mousemove', moveHandler);
    window.addEventListener('touchmove', (e) => {
        e.preventDefault();
        moveHandler(e);
    }, { passive: false });

    window.onload = init;
</script>
</body>
</html>
